{% extends "olfy/Ahuja labs website/base.html" %}
{% load static %}
{% block content %}
	<div style="background: #00000050; left: 0; top: 77px; z-index: 10;" id="loadContent" class="d-none text-center position-fixed h-100 w-100">
		<svg onclick="closeitem();" style="cursor: pointer; position: absolute; right: 0; top: 0;" width="40" height="40" viewBox="0 0 16 16" class="bi bi-x-circle-fill" fill="#dc3545" xmlns="http://www.w3.org/2000/svg">
			<path fill-rule="evenodd" d="M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0zM5.354 4.646a.5.5 0 1 0-.708.708L7.293 8l-2.647 2.646a.5.5 0 0 0 .708.708L8 8.707l2.646 2.647a.5.5 0 0 0 .708-.708L8.707 8l2.647-2.646a.5.5 0 0 0-.708-.708L8 7.293 5.354 4.646z"/>
		  </svg>
		<img style="max-height: 100%; max-width: 100%;" src="" id="imageContent" />
		<iframe id="pdflink" src="" style="height: calc(100vh - 77px); width: 90vw;" type="application/pdf"></iframe> <br />
		<a id="imageDownload" href="" download>
			<button class="mt-3 btn btn-lg rounded-lg border-0 shadow-lg bg-white text-dark">
				Download
			</button>
		</a>
	</div>
	<div class="loadFade px-md-5 container-fluid text-white">
		<div class="mt-5 row">
			{% if z == False %}
			<div class="container-fluid text-center">
				<h2 class="d-none d-md-block text-center">
					No results found. 
				</h2>
				<h2 class="d-block d-md-none">
					No results found.
				</h2>
				<h3 class="mt-4">
					To browse precomputed results, please go to <a class='text-white border-bottom' href = "queue">History</a>
				</h3>
			</div>
			{% else %}
				<div class="col-12 h-md-100 d-flex flex-column align-items-center text-left text-white">
					<div class="w-100 d-flex flex-row align-items-center justify-content-between">
						<h1 class="d-none d-md-block">
							Job Name: {{result.job_name}}
						</h1>
						<h2 class="d-block d-md-none">
							Job Name: {{result.job_name}}
						</h2>
						<a href="{% url 'download' result.job_name result.model result.count flag%}" target="_blank">
							<button class="mt-3 btn btn-lg rounded-lg border-0 shadow-lg bg-white text-dark">Download Zip</button>
						</a>
					</div>
					{% for i in display %}
						<div class="mt-5 text-left table-responsive">
							{% if result.model == 2 %}
								<h4>{{i.smiles}}</h4>
							{% elif result.model == 3 %}
								<h4> {{i.seq}}</h4>
							{% endif %}
							<table class="mt-2 table text-white">
								<thead>
									<tr>
										<th scope="col">S. No.</th>
										{% if result.model == 1 %}
											<th scope="col">SMILE</th>
											<th scope="col">Odor</th>
										{% elif result.model == 2 %}
											<th scope="col">Receptor Name</th>
											<th scope="col">Sequence</th>
										{% elif result.model == 3 %}
											<th scope="col">Odor Ligand(Smile)</th>
										{% elif result.model == 4 %}
											<th scope="col">SMILE</th>
											<th scope="col">Sequence</th>
											<th scope="col">Activation status</th>
										{% endif %}
										<th scope="col">Probability of Prediction</th>
										{% if result.model == 4 %}
										<th scope="col">Receptor Sequence Interpretability</th>
										{% endif %}
										{% if result.model == 3 %}
										<th scope="col">Receptor Sequence Interpretability</th>
										{% endif %}
										{% if result.model == 2 %}
											<th scope="col">Receptor Sequence Interpretability</th>
										{% endif %}										
										<th scope="col">SMILES Interpretability (Bar Graph)</th>
										<th scope="col">SMILES Interpretability (Structure)</th>
									</tr>
								</thead>
								<tbody>
									{% for j in i.row %}
										<tr>
											<th scope="row">{{j.sno}}</th>
											{% if result.model == 2 %}
												<td>{{j.receptorname}}</td>
												
												<td data-toggle="tooltip" data-placement="top" title="{{j.seq}}">{{ j.seq|truncatechars:10 }}</td>
												<td>{{j.prob}}</td>
												{% if j.noresult == False %}
												<td><a onclick=openitem("{{baseurl}}/{{result.id}}/m2/{{result.job_name}}/{{j.tableno}}/{{j.sno}}_SequenceInterpretability.pdf")>Graph &nbsp; <svg aria-hidden="true" focusable="false" data-prefix="fal" data-icon="external-link" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" style="height: 15px;" class="svg-inline--fa fa-external-link fa-w-16 fa-2x"><path fill="currentColor" d="M440,256H424a8,8,0,0,0-8,8V464a16,16,0,0,1-16,16H48a16,16,0,0,1-16-16V112A16,16,0,0,1,48,96H248a8,8,0,0,0,8-8V72a8,8,0,0,0-8-8H48A48,48,0,0,0,0,112V464a48,48,0,0,0,48,48H400a48,48,0,0,0,48-48V264A8,8,0,0,0,440,256ZM500,0,364,.34a12,12,0,0,0-12,12v10a12,12,0,0,0,12,12L454,34l.7.71L131.51,357.86a12,12,0,0,0,0,17l5.66,5.66a12,12,0,0,0,17,0L477.29,57.34l.71.7-.34,90a12,12,0,0,0,12,12h10a12,12,0,0,0,12-12L512,12A12,12,0,0,0,500,0Z" class=""></path></svg></a></td>
												<td><a onclick=openitem("{{baseurl}}/{{result.id}}/m2/{{result.job_name}}/{{j.tableno}}/{{j.sno}}_SmileInterpretability.png")>Graph &nbsp; <svg aria-hidden="true" focusable="false" data-prefix="fal" data-icon="external-link" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" style="height: 15px;" class="svg-inline--fa fa-external-link fa-w-16 fa-2x"><path fill="currentColor" d="M440,256H424a8,8,0,0,0-8,8V464a16,16,0,0,1-16,16H48a16,16,0,0,1-16-16V112A16,16,0,0,1,48,96H248a8,8,0,0,0,8-8V72a8,8,0,0,0-8-8H48A48,48,0,0,0,0,112V464a48,48,0,0,0,48,48H400a48,48,0,0,0,48-48V264A8,8,0,0,0,440,256ZM500,0,364,.34a12,12,0,0,0-12,12v10a12,12,0,0,0,12,12L454,34l.7.71L131.51,357.86a12,12,0,0,0,0,17l5.66,5.66a12,12,0,0,0,17,0L477.29,57.34l.71.7-.34,90a12,12,0,0,0,12,12h10a12,12,0,0,0,12-12L512,12A12,12,0,0,0,500,0Z" class=""></path></svg></a></td>
												<td><a onclick=openitem("{{baseurl}}/{{result.id}}/m2/{{result.job_name}}/{{j.tableno}}/{{j.sno}}_mol.svg")>Molecule &nbsp; <svg aria-hidden="true" focusable="false" data-prefix="fal" data-icon="external-link" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" style="height: 15px;" class="svg-inline--fa fa-external-link fa-w-16 fa-2x"><path fill="currentColor" d="M440,256H424a8,8,0,0,0-8,8V464a16,16,0,0,1-16,16H48a16,16,0,0,1-16-16V112A16,16,0,0,1,48,96H248a8,8,0,0,0,8-8V72a8,8,0,0,0-8-8H48A48,48,0,0,0,0,112V464a48,48,0,0,0,48,48H400a48,48,0,0,0,48-48V264A8,8,0,0,0,440,256ZM500,0,364,.34a12,12,0,0,0-12,12v10a12,12,0,0,0,12,12L454,34l.7.71L131.51,357.86a12,12,0,0,0,0,17l5.66,5.66a12,12,0,0,0,17,0L477.29,57.34l.71.7-.34,90a12,12,0,0,0,12,12h10a12,12,0,0,0,12-12L512,12A12,12,0,0,0,500,0Z" class=""></path></svg></a></td>
												{% else %}
												<td>NA</td>
												<td>NA</td>
												<td>NA</td>
												{% endif %}
											{% elif result.model == 3 %}
												<td>{{j.smiles}}</td>
												<td>{{j.prob}}</td>
												{% if j.noresult == False %}
												<td><a onclick=openitem("{{baseurl}}/{{result.id}}/m3/{{result.job_name}}/{{j.tableno}}/{{j.sno}}_SequenceInterpretability.pdf")>Graph &nbsp; <svg aria-hidden="true" focusable="false" data-prefix="fal" data-icon="external-link" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" style="height: 15px;" class="svg-inline--fa fa-external-link fa-w-16 fa-2x"><path fill="currentColor" d="M440,256H424a8,8,0,0,0-8,8V464a16,16,0,0,1-16,16H48a16,16,0,0,1-16-16V112A16,16,0,0,1,48,96H248a8,8,0,0,0,8-8V72a8,8,0,0,0-8-8H48A48,48,0,0,0,0,112V464a48,48,0,0,0,48,48H400a48,48,0,0,0,48-48V264A8,8,0,0,0,440,256ZM500,0,364,.34a12,12,0,0,0-12,12v10a12,12,0,0,0,12,12L454,34l.7.71L131.51,357.86a12,12,0,0,0,0,17l5.66,5.66a12,12,0,0,0,17,0L477.29,57.34l.71.7-.34,90a12,12,0,0,0,12,12h10a12,12,0,0,0,12-12L512,12A12,12,0,0,0,500,0Z" class=""></path></svg></a></td>
												<td><a onclick=openitem("{{baseurl}}/{{result.id}}/m3/{{result.job_name}}/{{j.tableno}}/{{j.sno}}_SmileInterpretability.png")>Graph &nbsp; <svg aria-hidden="true" focusable="false" data-prefix="fal" data-icon="external-link" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" style="height: 15px;" class="svg-inline--fa fa-external-link fa-w-16 fa-2x"><path fill="currentColor" d="M440,256H424a8,8,0,0,0-8,8V464a16,16,0,0,1-16,16H48a16,16,0,0,1-16-16V112A16,16,0,0,1,48,96H248a8,8,0,0,0,8-8V72a8,8,0,0,0-8-8H48A48,48,0,0,0,0,112V464a48,48,0,0,0,48,48H400a48,48,0,0,0,48-48V264A8,8,0,0,0,440,256ZM500,0,364,.34a12,12,0,0,0-12,12v10a12,12,0,0,0,12,12L454,34l.7.71L131.51,357.86a12,12,0,0,0,0,17l5.66,5.66a12,12,0,0,0,17,0L477.29,57.34l.71.7-.34,90a12,12,0,0,0,12,12h10a12,12,0,0,0,12-12L512,12A12,12,0,0,0,500,0Z" class=""></path></svg></a></td>
												<td><a onclick=openitem("{{baseurl}}/{{result.id}}/m3/{{result.job_name}}/{{j.tableno}}/{{j.sno}}_mol.svg")>Graph &nbsp; <svg aria-hidden="true" focusable="false" data-prefix="fal" data-icon="external-link" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" style="height: 15px;" class="svg-inline--fa fa-external-link fa-w-16 fa-2x"><path fill="currentColor" d="M440,256H424a8,8,0,0,0-8,8V464a16,16,0,0,1-16,16H48a16,16,0,0,1-16-16V112A16,16,0,0,1,48,96H248a8,8,0,0,0,8-8V72a8,8,0,0,0-8-8H48A48,48,0,0,0,0,112V464a48,48,0,0,0,48,48H400a48,48,0,0,0,48-48V264A8,8,0,0,0,440,256ZM500,0,364,.34a12,12,0,0,0-12,12v10a12,12,0,0,0,12,12L454,34l.7.71L131.51,357.86a12,12,0,0,0,0,17l5.66,5.66a12,12,0,0,0,17,0L477.29,57.34l.71.7-.34,90a12,12,0,0,0,12,12h10a12,12,0,0,0,12-12L512,12A12,12,0,0,0,500,0Z" class=""></path></svg></a></td>
												{% else %}
												<td>NA</td>
												<td>NA</td>
												<td>NA</td>
												{% endif %}
											{% elif result.model == 1 %}
												<td>{{j.smiles}}</td>
												<td>{{j.odor}}</td>
												<td>{{j.prob}}</td>
												<td><a onclick=openitem("{{baseurl}}/{{result.id}}/m1/{{result.job_name}}/{{j.sno}}/lrp.pdf")>
													Graph &nbsp; <svg aria-hidden="true" focusable="false" data-prefix="fal" data-icon="external-link" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" style="height: 15px;" class="svg-inline--fa fa-external-link fa-w-16 fa-2x"><path fill="currentColor" d="M440,256H424a8,8,0,0,0-8,8V464a16,16,0,0,1-16,16H48a16,16,0,0,1-16-16V112A16,16,0,0,1,48,96H248a8,8,0,0,0,8-8V72a8,8,0,0,0-8-8H48A48,48,0,0,0,0,112V464a48,48,0,0,0,48,48H400a48,48,0,0,0,48-48V264A8,8,0,0,0,440,256ZM500,0,364,.34a12,12,0,0,0-12,12v10a12,12,0,0,0,12,12L454,34l.7.71L131.51,357.86a12,12,0,0,0,0,17l5.66,5.66a12,12,0,0,0,17,0L477.29,57.34l.71.7-.34,90a12,12,0,0,0,12,12h10a12,12,0,0,0,12-12L512,12A12,12,0,0,0,500,0Z" class=""></path></svg>
												</a></td>
												<td><a onclick=openitem("{{baseurl}}/{{result.id}}/m1/{{result.job_name}}/{{j.sno}}/mol.svg")>
													Molecule &nbsp; <svg aria-hidden="true" focusable="false" data-prefix="fal" data-icon="external-link" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" style="height: 15px;" class="svg-inline--fa fa-external-link fa-w-16 fa-2x"><path fill="currentColor" d="M440,256H424a8,8,0,0,0-8,8V464a16,16,0,0,1-16,16H48a16,16,0,0,1-16-16V112A16,16,0,0,1,48,96H248a8,8,0,0,0,8-8V72a8,8,0,0,0-8-8H48A48,48,0,0,0,0,112V464a48,48,0,0,0,48,48H400a48,48,0,0,0,48-48V264A8,8,0,0,0,440,256ZM500,0,364,.34a12,12,0,0,0-12,12v10a12,12,0,0,0,12,12L454,34l.7.71L131.51,357.86a12,12,0,0,0,0,17l5.66,5.66a12,12,0,0,0,17,0L477.29,57.34l.71.7-.34,90a12,12,0,0,0,12,12h10a12,12,0,0,0,12-12L512,12A12,12,0,0,0,500,0Z" class=""></path></svg>
												</a></td>
											{% elif result.model == 4 %}
												<td>{{j.smiles}}</td>
												<td data-toggle="tooltip" data-placement="right" title="{{j.seq}}">{{ j.seq|truncatechars:10 }}</td>
												<td>{{j.status}}</td>
												<td>{{j.prob}}</td>
												<td><a onclick=openitem("{{baseurl}}/{{result.id}}/m4/{{result.job_name}}/{{j.tableno}}/{{j.sno}}_SequenceInterpretability.pdf")>Graph &nbsp; <svg aria-hidden="true" focusable="false" data-prefix="fal" data-icon="external-link" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" style="height: 15px;" class="svg-inline--fa fa-external-link fa-w-16 fa-2x"><path fill="currentColor" d="M440,256H424a8,8,0,0,0-8,8V464a16,16,0,0,1-16,16H48a16,16,0,0,1-16-16V112A16,16,0,0,1,48,96H248a8,8,0,0,0,8-8V72a8,8,0,0,0-8-8H48A48,48,0,0,0,0,112V464a48,48,0,0,0,48,48H400a48,48,0,0,0,48-48V264A8,8,0,0,0,440,256ZM500,0,364,.34a12,12,0,0,0-12,12v10a12,12,0,0,0,12,12L454,34l.7.71L131.51,357.86a12,12,0,0,0,0,17l5.66,5.66a12,12,0,0,0,17,0L477.29,57.34l.71.7-.34,90a12,12,0,0,0,12,12h10a12,12,0,0,0,12-12L512,12A12,12,0,0,0,500,0Z" class=""></path></svg></a></td>
												<td><a onclick=openitem("{{baseurl}}/{{result.id}}/m4/{{result.job_name}}/{{j.tableno}}/{{j.sno}}_SmileInterpretability.png")>Graph &nbsp; <svg aria-hidden="true" focusable="false" data-prefix="fal" data-icon="external-link" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" style="height: 15px;" class="svg-inline--fa fa-external-link fa-w-16 fa-2x"><path fill="currentColor" d="M440,256H424a8,8,0,0,0-8,8V464a16,16,0,0,1-16,16H48a16,16,0,0,1-16-16V112A16,16,0,0,1,48,96H248a8,8,0,0,0,8-8V72a8,8,0,0,0-8-8H48A48,48,0,0,0,0,112V464a48,48,0,0,0,48,48H400a48,48,0,0,0,48-48V264A8,8,0,0,0,440,256ZM500,0,364,.34a12,12,0,0,0-12,12v10a12,12,0,0,0,12,12L454,34l.7.71L131.51,357.86a12,12,0,0,0,0,17l5.66,5.66a12,12,0,0,0,17,0L477.29,57.34l.71.7-.34,90a12,12,0,0,0,12,12h10a12,12,0,0,0,12-12L512,12A12,12,0,0,0,500,0Z" class=""></path></svg></a></td>
												<td><a onclick=openitem("{{baseurl}}/{{result.id}}/m4/{{result.job_name}}/{{j.tableno}}/{{j.sno}}_mol.svg")>Molecule &nbsp; <svg aria-hidden="true" focusable="false" data-prefix="fal" data-icon="external-link" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" style="height: 15px;" class="svg-inline--fa fa-external-link fa-w-16 fa-2x"><path fill="currentColor" d="M440,256H424a8,8,0,0,0-8,8V464a16,16,0,0,1-16,16H48a16,16,0,0,1-16-16V112A16,16,0,0,1,48,96H248a8,8,0,0,0,8-8V72a8,8,0,0,0-8-8H48A48,48,0,0,0,0,112V464a48,48,0,0,0,48,48H400a48,48,0,0,0,48-48V264A8,8,0,0,0,440,256ZM500,0,364,.34a12,12,0,0,0-12,12v10a12,12,0,0,0,12,12L454,34l.7.71L131.51,357.86a12,12,0,0,0,0,17l5.66,5.66a12,12,0,0,0,17,0L477.29,57.34l.71.7-.34,90a12,12,0,0,0,12,12h10a12,12,0,0,0,12-12L512,12A12,12,0,0,0,500,0Z" class=""></path></svg></a></td>
											{% endif %}
										</tr>
									{% endfor %}
								</tbody>
							</table>
						</div>
					{% endfor %}
				</div>
			{% endif %}
		</div>
	</div>
	<script>
		$(document).keyup(function(e) {
			if (e.key === "Escape") {
				closeitem();
			}
		});
		function openitem(URL){
			if(URL.endsWith('.pdf')){
				$('#loadContent').removeClass('d-none');
				$('#pdflink').attr('src', URL);
				$('#imageContent').addClass('d-none');
				$('#imageDownload').addClass('d-none');
			}
			else{
				$('#loadContent').removeClass('d-none');
				$('#imageContent').attr('src', URL);
				$('#imageDownload').attr('href', URL);
				$('#pdflink').addClass('d-none');
				$('#imageDownload').removeClass('d-none');
			}
		}
		function closeitem(){
			$('#loadContent').addClass('d-none');
			$('#pdflink').removeClass('d-none');
			$('#imageContent').removeClass('d-none');
			$('#imageDownload').removeClass('d-none');
		}
	</script>
{% endblock %}
